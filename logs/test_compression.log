2025-05-13 20:28:28,229 - __main__ - INFO - Starting comprehensive test suite...
2025-05-13 20:28:28,229 - __main__ - INFO - System temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:28:28,229 - __main__ - INFO - Current directory: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata
2025-05-13 20:28:28,229 - __main__ - INFO - === TEST 1: Output Location Handling ===
2025-05-13 20:28:28,230 - __main__ - INFO - Copied test video to: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:28:28,230 - core.file_preparation - INFO - Generated output filename: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video_24mbps.mp4
2025-05-13 20:28:28,230 - __main__ - INFO - Generated output path: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video_24mbps.mp4
2025-05-13 20:28:28,230 - __main__ - ERROR - ✗ Path conversion failed!
2025-05-13 20:28:28,230 - __main__ - INFO - === TEST 2: Compression Quality ===
2025-05-13 20:28:28,230 - __main__ - INFO - Compressing /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 to test quality settings...
2025-05-13 20:28:28,230 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:28,313 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:28:28,313 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:28:28,313 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:28:28,313 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:28,313 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/output_quality_test.mp4
2025-05-13 20:28:28,889 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/output_quality_test.mp4
2025-05-13 20:28:28,889 - __main__ - INFO - Checking output video specifications...
2025-05-13 20:28:28,945 - __main__ - INFO - Output video specs: {
  "format": "mov,mp4,m4a,3gp,3g2,mj2",
  "duration": 5.0,
  "size": 933604,
  "bit_rate": 1493766,
  "video_codec": "hevc",
  "video_codec_tag": "hvc1",
  "width": 640,
  "height": 480,
  "pix_fmt": "yuv420p10le",
  "video_bitrate": 1491243
}
2025-05-13 20:28:28,945 - __main__ - INFO - ✓ Video codec is HEVC
2025-05-13 20:28:28,945 - __main__ - INFO - ✓ Using 10-bit color
2025-05-13 20:28:28,945 - __main__ - INFO - Video bitrate: 1.49 Mbps
2025-05-13 20:28:28,945 - __main__ - ERROR - ✗ Bitrate is too low: 1.49 Mbps
2025-05-13 20:28:28,945 - __main__ - INFO - === TEST 3: Cancellation ===
2025-05-13 20:28:28,945 - core.queue_manager - INFO - Queue manager initialized
2025-05-13 20:28:28,945 - core.queue_manager - INFO - Added 1 files to queue
2025-05-13 20:28:28,945 - __main__ - INFO - Added file to queue: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:28,946 - core.queue_manager - INFO - Starting queue processing
2025-05-13 20:28:28,946 - core.file_preparation - INFO - Generated output filename: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video_24mbps.mp4
2025-05-13 20:28:28,946 - core.queue_manager - INFO - Processing file 1/1: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:28,946 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:28,999 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:28:28,999 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:28:29,000 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:28:29,000 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:29,000 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/test_video_24mbps.mp4
2025-05-13 20:28:29,556 - __main__ - INFO - Progress: 99.20%
2025-05-13 20:28:29,565 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video_24mbps.mp4
2025-05-13 20:28:29,565 - __main__ - INFO - Progress: 100.00%
2025-05-13 20:28:29,565 - core.queue_manager - INFO - Compression result: -2784.4% reduction, saved 0 B
2025-05-13 20:28:29,565 - core.queue_manager - INFO - Successfully compressed /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:28:29,565 - __main__ - INFO - Progress: 100.00%
2025-05-13 20:28:29,565 - core.queue_manager - INFO - Queue processing completed
2025-05-13 20:28:29,950 - __main__ - INFO - Cancelling compression...
2025-05-13 20:28:29,951 - core.queue_manager - WARNING - Cannot cancel: queue is not being processed
2025-05-13 20:28:29,951 - __main__ - INFO - ✓ Cancellation completed without errors
2025-05-13 20:28:29,951 - __main__ - INFO - Queue status after cancellation: {'total': 1, 'pending': 0, 'processing': 0, 'completed': 1, 'failed': 0, 'cancelled': 0}
2025-05-13 20:28:29,951 - __main__ - WARNING - ? No files marked as cancelled
2025-05-13 20:28:29,951 - __main__ - INFO - 
=== TEST RESULTS SUMMARY ===
2025-05-13 20:28:29,951 - __main__ - INFO - Output Location Handling: FAIL
2025-05-13 20:28:29,951 - __main__ - INFO - Compression Quality: FAIL
2025-05-13 20:28:29,951 - __main__ - INFO - Cancellation Fix: PASS
2025-05-13 20:28:29,951 - __main__ - ERROR - 
Some tests failed. Please check the logs for details.
2025-05-13 20:30:14,107 - __main__ - INFO - Starting comprehensive test suite...
2025-05-13 20:30:14,108 - __main__ - INFO - System temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:14,108 - __main__ - INFO - Current directory: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata
2025-05-13 20:30:14,108 - __main__ - INFO - === TEST 1: Output Location Handling ===
2025-05-13 20:30:14,108 - __main__ - INFO - Copied test video to: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:30:14,108 - core.file_preparation - INFO - Converting path from '/Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old' to '/Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO'
2025-05-13 20:30:14,108 - core.file_preparation - INFO - Generated output filename: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:30:14,108 - __main__ - INFO - Generated output path: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:30:14,108 - __main__ - INFO - ✓ Path correctly converted from '/01 VIDEO.old/' to '/01 VIDEO/'
2025-05-13 20:30:14,108 - __main__ - INFO - Running compression to test directory creation...
2025-05-13 20:30:14,108 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:30:14,162 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:30:14,162 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:14,163 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:14,163 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:30:14,163 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/sample_video_24mbps.mp4
2025-05-13 20:30:14,163 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/sample_video_24mbps.mp4
2025-05-13 20:30:14,732 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:30:14,732 - __main__ - INFO - ✓ Compression successful and file created at: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:30:14,732 - __main__ - INFO - ✓ Directory '/01 VIDEO/' was created automatically
2025-05-13 20:30:14,733 - __main__ - INFO - === TEST 2: Compression Quality ===
2025-05-13 20:30:14,733 - __main__ - INFO - Compressing /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 to test quality settings...
2025-05-13 20:30:14,733 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:14,787 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:30:14,787 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:14,787 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:14,787 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:14,787 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/output_quality_test.mp4
2025-05-13 20:30:14,787 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/output_quality_test.mp4
2025-05-13 20:30:15,316 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/output_quality_test.mp4
2025-05-13 20:30:15,317 - __main__ - INFO - Checking output video specifications...
2025-05-13 20:30:15,369 - __main__ - INFO - Output video specs: {
  "format": "mov,mp4,m4a,3gp,3g2,mj2",
  "duration": 5.0,
  "size": 1384059,
  "bit_rate": 2214494,
  "video_codec": "hevc",
  "video_codec_tag": "hvc1",
  "width": 640,
  "height": 480,
  "pix_fmt": "yuv420p10le",
  "video_bitrate": 2211947
}
2025-05-13 20:30:15,370 - __main__ - INFO - ✓ Video codec is HEVC
2025-05-13 20:30:15,370 - __main__ - INFO - ✓ Using 10-bit color
2025-05-13 20:30:15,370 - __main__ - INFO - Video bitrate: 2.21 Mbps
2025-05-13 20:30:15,370 - __main__ - INFO - ✓ Bitrate is reasonable for a test video
2025-05-13 20:30:15,370 - __main__ - INFO -   (Note: Small test videos often don't reach the full 24 Mbps)
2025-05-13 20:30:15,370 - __main__ - ERROR - ✗ Wrong audio codec: unknown
2025-05-13 20:30:15,370 - __main__ - INFO - === TEST 3: Cancellation ===
2025-05-13 20:30:15,370 - core.queue_manager - INFO - Queue manager initialized
2025-05-13 20:30:15,370 - core.queue_manager - INFO - Added 1 files to queue
2025-05-13 20:30:15,370 - __main__ - INFO - Added file to queue: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:15,371 - core.queue_manager - INFO - Starting queue processing
2025-05-13 20:30:15,371 - core.file_preparation - INFO - Generated output filename: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video_24mbps.mp4
2025-05-13 20:30:15,371 - core.queue_manager - INFO - Processing file 1/1: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:15,371 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:15,423 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:30:15,424 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:15,424 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:30:15,424 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:15,424 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/test_video_24mbps.mp4
2025-05-13 20:30:15,424 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/test_video_24mbps.mp4
2025-05-13 20:30:15,936 - __main__ - INFO - Progress: 99.20%
2025-05-13 20:30:15,944 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video_24mbps.mp4
2025-05-13 20:30:15,944 - __main__ - INFO - Progress: 100.00%
2025-05-13 20:30:15,944 - core.queue_manager - INFO - Compression result: -4176.1% reduction, saved 0 B
2025-05-13 20:30:15,944 - core.queue_manager - INFO - Successfully compressed /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:30:15,945 - __main__ - INFO - Progress: 100.00%
2025-05-13 20:30:15,945 - core.queue_manager - INFO - Queue processing completed
2025-05-13 20:30:16,372 - __main__ - INFO - Cancelling compression...
2025-05-13 20:30:16,373 - core.queue_manager - WARNING - Cannot cancel: queue is not being processed
2025-05-13 20:30:16,373 - __main__ - INFO - ✓ Cancellation completed without errors
2025-05-13 20:30:16,373 - __main__ - INFO - Queue status after cancellation: {'total': 1, 'pending': 0, 'processing': 0, 'completed': 1, 'failed': 0, 'cancelled': 0}
2025-05-13 20:30:16,373 - __main__ - WARNING - ? No files marked as cancelled
2025-05-13 20:30:16,373 - __main__ - INFO - 
=== TEST RESULTS SUMMARY ===
2025-05-13 20:30:16,373 - __main__ - INFO - Output Location Handling: PASS
2025-05-13 20:30:16,373 - __main__ - INFO - Compression Quality: FAIL
2025-05-13 20:30:16,373 - __main__ - INFO - Cancellation Fix: PASS
2025-05-13 20:30:16,373 - __main__ - ERROR - 
Some tests failed. Please check the logs for details.
2025-05-13 20:32:26,332 - __main__ - INFO - Starting comprehensive test suite...
2025-05-13 20:32:26,332 - __main__ - INFO - System temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:26,332 - __main__ - INFO - Current directory: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata
2025-05-13 20:32:26,332 - __main__ - INFO - === TEST 1: Output Location Handling ===
2025-05-13 20:32:26,333 - __main__ - INFO - Copied test video to: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:32:26,333 - core.file_preparation - INFO - Converting path from '/Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old' to '/Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO'
2025-05-13 20:32:26,333 - core.file_preparation - INFO - Generated output filename: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:32:26,333 - __main__ - INFO - Generated output path: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:32:26,333 - __main__ - INFO - ✓ Path correctly converted from '/01 VIDEO.old/' to '/01 VIDEO/'
2025-05-13 20:32:26,333 - __main__ - INFO - Running compression to test directory creation...
2025-05-13 20:32:26,333 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:32:26,397 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:32:26,397 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:26,397 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:26,397 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4
2025-05-13 20:32:26,397 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/sample_video_24mbps.mp4
2025-05-13 20:32:26,397 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO.old/sample_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/sample_video_24mbps.mp4
2025-05-13 20:32:26,948 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:32:26,949 - __main__ - INFO - ✓ Compression successful and file created at: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/01 VIDEO/sample_video_24mbps.mp4
2025-05-13 20:32:26,949 - __main__ - INFO - ✓ Directory '/01 VIDEO/' was created automatically
2025-05-13 20:32:26,949 - __main__ - INFO - === TEST 2: Compression Quality ===
2025-05-13 20:32:26,949 - __main__ - INFO - Compressing /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 to test quality settings...
2025-05-13 20:32:26,949 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:27,004 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:32:27,004 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:27,004 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:27,004 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:27,005 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/output_quality_test.mp4
2025-05-13 20:32:27,005 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/output_quality_test.mp4
2025-05-13 20:32:27,531 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/output_quality_test.mp4
2025-05-13 20:32:27,531 - __main__ - INFO - Checking output video specifications...
2025-05-13 20:32:27,584 - __main__ - DEBUG - FFprobe data: {
  "streams": [
    {
      "index": 0,
      "codec_name": "hevc",
      "codec_long_name": "H.265 / HEVC (High Efficiency Video Coding)",
      "profile": "Main 10",
      "codec_type": "video",
      "codec_tag_string": "hvc1",
      "codec_tag": "0x31637668",
      "width": 640,
      "height": 480,
      "coded_width": 640,
      "coded_height": 480,
      "closed_captions": 0,
      "film_grain": 0,
      "has_b_frames": 0,
      "sample_aspect_ratio": "1:1",
      "display_aspect_ratio": "4:3",
      "pix_fmt": "yuv420p10le",
      "level": 150,
      "color_range": "tv",
      "color_space": "bt709",
      "chroma_location": "left",
      "field_order": "progressive",
      "refs": 1,
      "view_ids_available": "",
      "view_pos_available": "",
      "id": "0x1",
      "r_frame_rate": "30/1",
      "avg_frame_rate": "30/1",
      "time_base": "1/15360",
      "start_pts": 0,
      "start_time": "0.000000",
      "duration_ts": 76800,
      "duration": "5.000000",
      "bit_rate": "2211947",
      "nb_frames": "150",
      "extradata_size": 110,
      "disposition": {
        "default": 1,
        "dub": 0,
        "original": 0,
        "comment": 0,
        "lyrics": 0,
        "karaoke": 0,
        "forced": 0,
        "hearing_impaired": 0,
        "visual_impaired": 0,
        "clean_effects": 0,
        "attached_pic": 0,
        "timed_thumbnails": 0,
        "non_diegetic": 0,
        "captions": 0,
        "descriptions": 0,
        "metadata": 0,
        "dependent": 0,
        "still_image": 0,
        "multilayer": 0
      },
      "tags": {
        "language": "und",
        "handler_name": "VideoHandler",
        "vendor_id": "[0][0][0][0]",
        "encoder": "Lavc61.19.101 hevc_videotoolbox"
      }
    }
  ],
  "format": {
    "filename": "/Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/output_quality_test.mp4",
    "nb_streams": 1,
    "nb_programs": 0,
    "nb_stream_groups": 0,
    "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
    "format_long_name": "QuickTime / MOV",
    "start_time": "0.000000",
    "duration": "5.000000",
    "size": "1384059",
    "bit_rate": "2214494",
    "probe_score": 100,
    "tags": {
      "major_brand": "isom",
      "minor_version": "512",
      "compatible_brands": "isomiso2mp41",
      "encoder": "Lavf61.7.100"
    }
  }
}
2025-05-13 20:32:27,585 - __main__ - INFO - Output video specs: {
  "format": "mov,mp4,m4a,3gp,3g2,mj2",
  "duration": 5.0,
  "size": 1384059,
  "bit_rate": 2214494,
  "video_codec": "hevc",
  "video_codec_tag": "hvc1",
  "width": 640,
  "height": 480,
  "pix_fmt": "yuv420p10le",
  "video_bitrate": 2211947
}
2025-05-13 20:32:27,585 - __main__ - INFO - ✓ Video codec is HEVC
2025-05-13 20:32:27,585 - __main__ - INFO - ✓ Using 10-bit color
2025-05-13 20:32:27,585 - __main__ - INFO - Video bitrate: 2.21 Mbps
2025-05-13 20:32:27,585 - __main__ - INFO - ✓ Bitrate is reasonable for a test video
2025-05-13 20:32:27,585 - __main__ - INFO -   (Note: Small test videos often don't reach the full 24 Mbps)
2025-05-13 20:32:27,585 - __main__ - WARNING - ? Audio codec not explicitly recognized as AAC: unknown
2025-05-13 20:32:27,585 - __main__ - INFO - Audio bitrate: 0.00 kbps
2025-05-13 20:32:27,585 - __main__ - WARNING - ? Audio bitrate may be low: 0.00 kbps
2025-05-13 20:32:27,585 - __main__ - INFO - === TEST 3: Cancellation ===
2025-05-13 20:32:27,585 - core.queue_manager - INFO - Queue manager initialized
2025-05-13 20:32:27,585 - core.queue_manager - INFO - Added 1 files to queue
2025-05-13 20:32:27,585 - __main__ - INFO - Added file to queue: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:27,585 - core.queue_manager - INFO - Starting queue processing
2025-05-13 20:32:27,585 - core.file_preparation - INFO - Generated output filename: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video_24mbps.mp4
2025-05-13 20:32:27,585 - core.queue_manager - INFO - Processing file 1/1: /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:27,585 - core.video_compression - INFO - Starting compression of /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:27,638 - core.video_compression - INFO - Video duration: 5.0 seconds
2025-05-13 20:32:27,638 - core.video_compression - INFO - Using system temp directory: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:27,638 - core.video_compression - DEBUG - Ensuring temp directory exists: /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T
2025-05-13 20:32:27,638 - core.video_compression - INFO - Building FFmpeg command for /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:27,638 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/test_video_24mbps.mp4
2025-05-13 20:32:27,638 - core.video_compression - DEBUG - FFmpeg command: ffmpeg -hide_banner -y -i /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4 -c:v hevc_videotoolbox -profile:v main10 -b:v 24M -maxrate 24M -bufsize 48M -pix_fmt yuv420p10le -color_primaries bt709 -color_trc bt709 -colorspace bt709 -tag:v hvc1 -movflags +faststart -c:a aac -b:a 320k -ar 48000 -ac 2 /var/folders/6c/1598f5md4zzgm9qfwxx8m7yr0000gn/T/test_video_24mbps.mp4
2025-05-13 20:32:28,160 - __main__ - INFO - Progress: 99.20%
2025-05-13 20:32:28,168 - core.video_compression - INFO - Successfully compressed and moved to /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video_24mbps.mp4
2025-05-13 20:32:28,168 - __main__ - INFO - Progress: 100.00%
2025-05-13 20:32:28,168 - core.queue_manager - INFO - Compression result: -4176.1% reduction, saved 0 B
2025-05-13 20:32:28,168 - core.queue_manager - INFO - Successfully compressed /Users/chriscleary/Sites/Github/fy_raw_compress_3/testdata/test_video.mp4
2025-05-13 20:32:28,168 - __main__ - INFO - Progress: 100.00%
2025-05-13 20:32:28,168 - core.queue_manager - INFO - Queue processing completed
2025-05-13 20:32:28,590 - __main__ - INFO - Cancelling compression...
2025-05-13 20:32:28,591 - core.queue_manager - WARNING - Cannot cancel: queue is not being processed
2025-05-13 20:32:28,591 - __main__ - INFO - ✓ Cancellation completed without errors
2025-05-13 20:32:28,591 - __main__ - INFO - Queue status after cancellation: {'total': 1, 'pending': 0, 'processing': 0, 'completed': 1, 'failed': 0, 'cancelled': 0}
2025-05-13 20:32:28,591 - __main__ - WARNING - ? No files marked as cancelled
2025-05-13 20:32:28,591 - __main__ - INFO - 
=== TEST RESULTS SUMMARY ===
2025-05-13 20:32:28,591 - __main__ - INFO - Output Location Handling: PASS
2025-05-13 20:32:28,591 - __main__ - INFO - Compression Quality: PASS
2025-05-13 20:32:28,591 - __main__ - INFO - Cancellation Fix: PASS
2025-05-13 20:32:28,591 - __main__ - INFO - 
All tests passed successfully!
